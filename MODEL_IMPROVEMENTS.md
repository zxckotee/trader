# üöÄ –£–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 75% —Ç–æ—á–Ω–æ—Å—Ç–∏

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ:

### 1. **Consistency Loss** - —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ª–æ–≥–∏—Ç–æ–≤ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥–∏—Ç—ã –∏ direction –º–æ–≥–ª–∏ —Ä–∞—Å—Ö–æ–¥–∏—Ç—å—Å—è (price_logit –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π, –∞ direction –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç UP)
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω consistency_loss, –∫–æ—Ç–æ—Ä—ã–π —à—Ç—Ä–∞—Ñ—É–µ—Ç –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–Ω–∞–∫–æ–≤
- **–í–µ—Å**: 2.0 (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ config.json)

### 2. **Huber Loss –¥–ª—è price prediction**
- **–ü—Ä–æ–±–ª–µ–º–∞**: MSE —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Huber Loss (delta=0.05) –¥–ª—è –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **–í–∫–ª—é—á–µ–Ω–æ**: `use_huber_loss: true` –≤ config.json

### 3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Å–∞ loss —Ñ—É–Ω–∫—Ü–∏–π**
- **price_weight**: 1.0 ‚Üí **3.0** (–±–æ–ª—å—à–µ —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ª–æ–≥–∏—Ç–∞—Ö)
- **direction_weight**: **2.0** (–≤–∞–∂–Ω–æ –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- **consistency_weight**: **2.0** (–Ω–æ–≤–æ–µ, –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏)
- **volatility_weight**: 0.5 ‚Üí 0.3 (–º–µ–Ω—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è)
- **magnitude_weight**: 0.3 ‚Üí 0.2
- **percentile_weight**: 0.3 ‚Üí 0.2

### 4. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è**
- **learning_rate**: 0.00008 ‚Üí **0.00005** (–¥–ª—è fine-tuning)
- **min_lr**: 0.000001 ‚Üí **0.000002** (–≤—ã—à–µ –º–∏–Ω–∏–º—É–º)
- **early_stopping_patience**: 50 ‚Üí **100** (–±–æ–ª—å—à–µ —Ç–µ—Ä–ø–µ–Ω–∏—è)

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã!**
- –°—Ç–∞—Ä—ã–µ —á–µ–∫–ø–æ–∏–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- –ï—Å–ª–∏ `consistency_weight` –Ω–µ —É–∫–∞–∑–∞–Ω ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 0 (–≤—ã–∫–ª—é—á–µ–Ω)
- –ï—Å–ª–∏ `use_huber_loss` –Ω–µ —É–∫–∞–∑–∞–Ω ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ MSE (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- –í–µ—Å–∞ –º–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ–∫–ø–æ–∏–Ω—Ç–∞

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–° —ç—Ç–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:
- **–¢–µ–∫—É—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: 62.56% (—ç–ø–æ—Ö–∞ 420)
- **–û–∂–∏–¥–∞–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: ~70-75%
- **–£–ª—É—á—à–µ–Ω–∏–µ**: +7-12%

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç:

1. **Consistency Loss** ‚Üí –ª–æ–≥–∏—Ç—ã –∏ direction –≤—Å–µ–≥–¥–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç (+3-5%)
2. **Huber Loss** ‚Üí –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤—ã–±—Ä–æ—Å–∞—Ö (+2-3%)
3. **–ë–æ–ª—å—à–µ –≤–µ—Å–∞ –Ω–∞ price** ‚Üí –ª—É—á—à–∏–µ –ª–æ–≥–∏—Ç—ã (+2-3%)
4. **–ë–æ–ª—å—à–µ patience** ‚Üí –º–æ–¥–µ–ª—å —É—Å–ø–µ–µ—Ç —É–ª—É—á—à–∏—Ç—å—Å—è (+1-2%)

## üéØ –ö–∞–∫ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ:

```bash
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± - —Å –±—ç–∫–∞–ø–æ–º
cp models/best_model.pt models/best_model_backup.pt
cp models/checkpoint_epoch_419.pt models/checkpoint_epoch_419_backup.pt

# –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —á–µ–∫–ø–æ–∏–Ω—Ç–∞
python train.py \
  --auto-symbols \
  --epochs 1000 \
  --batch-size 32 \
  --device cuda \
  --resume models/checkpoint_epoch_419.pt
```

## üîç –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:

1. **Consistency Loss** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–ª–∏–∑–æ–∫ –∫ 0 (–ª–æ–≥ –ø–æ–∫–∞–∂–µ—Ç –≤ –ø–µ—Ä–≤–æ–º –±–∞—Ç—á–µ)
2. **Val Direction Accuracy** –¥–æ–ª–∂–Ω–∞ —Ä–∞—Å—Ç–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ
3. **Val Price Loss** –¥–æ–ª–∂–Ω–∞ —Å–Ω–∏–∂–∞—Ç—å—Å—è (Huber –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤)
4. **Total Loss** –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—à–µ –∏–∑-–∑–∞ consistency_weight, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

- **Optimizer –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å—Å—è** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ–∫–ø–æ–∏–Ω—Ç–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è
- **Scheduler –º–æ–∂–µ—Ç —Å–±—Ä–æ—Å–∏—Ç—å—Å—è** - —Ç–æ–∂–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è
- **–í—Å–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã** - –≥–ª–∞–≤–Ω–æ–µ –Ω–µ –ø–æ—Ç–µ—Ä—è–Ω–æ!

---

**–£–¥–∞—á–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è! üöÄ**

